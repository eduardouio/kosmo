{% load static %}
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{% static 'css/invoice_style.css' %}" rel="stylesheet" type="text/css" />
    <title>Comprobante de Cobro {{ collection.collection_number|default:collection.id }}</title>
    <link href="{% static 'css/collection_receipt.css' %}" rel="stylesheet" type="text/css" />

  </head>
  <body>
    <div class="container">
      <!-- Encabezado con logo y número de comprobante -->
      <div class="payment-header">
        <img src="https://kosmoflowers.com/wp-content/uploads/2022/07/Mesa-de-trabajo-6.svg" 
             alt="Logo Kosmo Flowers" class="payment-logo"/>
        <div class="payment-title">
          <h2>COMPROBANTE DE COBRO</h2>
          <p>No. {{ collection.payment_number|default:collection.id }}</p>
          <p>Fecha: {{ collection.date|date:'Y-m-d' }}</p>
        </div>
      </div>

      <!-- Información de la empresa -->
      <div class="company-info">
        <div class="company-info-left">
          <div><strong>Roses Grown by:</strong> KOSMO FLOWERS</div>
          <div><strong>Address:</strong> Tupigachi - Tabacundo</div>
          <div><strong>Country:</strong> ECUADOR</div>
        </div>
        <div class="company-info-right">
          <p><strong>Email:</strong> invoices@kosmoflowers.com</p>
          <p><strong>Phone:</strong> (+593) 0999475741</p>
        </div>
      </div>

      <!-- Información del cobro -->
      <div class="collection-info">
        <h2 class="section-title">Información del Cobro</h2>
        <div class="collection-info-container">
          <!-- Detalles del cobro a la izquierda -->
          <div class="collection-details">
            <div class="info-grid">
              <div class="info-label">Método de Pago:</div>
              <div>{{ collection.get_method_display|default:"No especificado" }}</div>
              
              <div class="info-label">Estado:</div>
              <div>{{ collection.get_status_display|default:"No especificado" }}</div>
              
              <div class="info-label">Tipo de Transacción:</div>
              <div>{{ collection.get_type_transaction_display|default:"No especificado" }}</div>
              
              {% if collection.bank %}
              <div class="info-label">Banco:</div>
              <div>{{ collection.bank }}</div>
              {% endif %}
              
              {% if collection.nro_operation %}
              <div class="info-label">Número de Operación:</div>
              <div>{{ collection.nro_operation }}</div>
              {% endif %}
              
              {% if collection.nro_account %}
              <div class="info-label">Número de Cuenta:</div>
              <div>{{ collection.nro_account }}</div>
              {% endif %}
              
              <div class="info-label">Monto Total:</div>
              <div style="font-weight: bold; color: #10b981;">${{ collection.amount|floatformat:2|default:"0.00" }}</div>
            </div>
          </div>
          
          <!-- Sección de imagen del cobro a la derecha -->
          <div class="collection-image-container">
            {% if collection.document %}
              <img src="{{ collection.document.url }}" alt="Comprobante de cobro" class="collection-image" />
            {% else %}
              <div class="collection-image-placeholder">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
                <p class="mt-2">No hay imagen de comprobante</p>
              </div>
            {% endif %}
          </div>
        </div>
      </div>

      <!-- Facturas relacionadas -->
      {% if collection_details %}
      <div class="invoices-section">
        <h2 class="section-title">Facturas Cobradas ({{ collection_details|length }})</h2>
        <table class="invoices-table">
          <thead>
            <tr>
              <th>Proveedor</th>
              <th>Factura</th>
              <th>Fecha</th>
              <th>Monto</th>
            </tr>
          </thead>
          <tbody>
            {% for detail in collection_details %}
            <tr>
              <td>{{ detail.invoice.partner.name|truncatechars:30 }}</td>
              <td>{{ detail.invoice.num_invoice }}</td>
              <td>{{ detail.invoice.date|date:'Y-m-d' }}</td>
              <td>${{ detail.amount|floatformat:2 }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        <div class="total-amount">
          Total Cobrado: ${{ collection.amount|floatformat:2 }}
        </div>
      </div>
      {% endif %}

      <!-- Información adicional -->
      <div class="additional-info">
        <h2 class="section-title">Información Adicional</h2>
        <div class="info-grid">
          <div class="info-label">Creado por:</div>
          <div>{{ user_created.get_full_name|default:user_created.username }} ({{ user_created.email }})</div>
          
          <div class="info-label">Fecha de generación:</div>
          <div>{{ now|date:'Y-m-d H:i:s' }}</div>
          
          {% if collection.notes %}
          <div class="info-label">Notas:</div>
          <div>{{ collection.notes|linebreaksbr }}</div>
          {% endif %}
        </div>
      </div>

      <!-- Pie de página -->
      <div class="footer">
        <p>Este es un documento generado electrónicamente por el sistema de KOSMO FLOWERS</p>
        <p>© {% now "Y" %} KOSMO FLOWERS - Todos los derechos reservados</p>
      </div>
    </div>
  </body>
</html>